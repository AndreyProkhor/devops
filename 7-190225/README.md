# Репозитории

## Репозиторий конфигурации ArgoCD

Данный репозиторий содержит конфигурационные файлы для ArgoCD, который управляет развертыванием приложений. ArgoCD позволяет автоматизировать и управлять развертываниями приложений в Kubernetes-кластере. Основные файлы:

### appFromRegistry.yaml

Этот файл содержит конфигурацию для приложений, которые загружаются из Docker-реестра. Он определяет, какие чарты Helm должны быть использованы для развертывания приложения и как они должны быть конфигурированы.

### confMonitorApp.yaml

Файл конфигурации для мониторинга приложения appFromRegistry.yaml. Он может содержать параметры для настройки мониторинга производительности, логирования и оповещений.

### proj.yaml

Файл конфигурации, специфичный для проекта. Он может содержать общие настройки проекта, такие как namespace, параметры безопасности и другие специфические для проекта параметры.

## Репозиторий Docker и Helm Chart

Этот репозиторий содержит код приложения, конфигурацию Docker и Helm charts, которые используются для развертывания приложения в Kubernetes-кластере. Основные компоненты:

### app.py

Основной код приложения, написанный на Python. Этот файл содержит логику приложения и может взаимодействовать с базами данных, API и другими сервисами.

### Dockerfile

Файл Dockerfile определяет процесс сборки Docker-образа, включая установку зависимостей, копирование файлов приложения и настройку окружения.

### requirements.txt

Файл, содержащий список зависимостей Python, необходимых для работы приложения. Используется для установки необходимых библиотек с помощью pip.

### charts

Директория содержит Helm charts, которые определяют, как приложение должно быть развернуто в Kubernetes. Helm charts включают в себя манифесты Kubernetes.

#### Логика и особенности реализации шаблонов в `charts/eugenechart/templates`

- **deploy.yaml**:
  - Определяет развертывание приложения в Kubernetes.
  - Включает спецификацию контейнеров, используемых образов, переменных окружения и объемов.

- **dhub-sec.yaml**:
  - Управляет секретами для доступа к Docker Hub.
  - Использует Kubernetes Secrets для безопасного хранения учетных данных.

- **env-sec.yaml**:
  - Конфигурирует переменные окружения и секреты, необходимые для работы приложения.
  - Хранит почтовую информацию

- **ingress.yaml**:
  - Определяет правила входа для маршрутизации внешнего трафика к приложению.
  - Поддерживает SSL/TLS для обеспечения безопасного соединения.
  - Включает настройки для балансировки нагрузки и маршрутизации на основе хоста или пути.

- **namespace.yaml**:
  - Создает изолированное пространство имен для ресурсов приложения.
  - Облегчает организацию и управление ресурсами.

- **prod_ClusterIssuer.yaml**:
  - Конфигурация для автоматического управления сертификатами с использованием Cert-Manager.
  - Поддерживает интеграцию с ACME-сертификатами для автоматического обновления SSL-сертификатов.
  - Может быть настроен для использования различных поставщиков сертификатов.
  - Штука прикольная.

- **service.yaml**:
  - Описывает сетевое взаимодействие приложения.

#### Другие файлы в `charts/eugenechart`

- **Chart.yaml**: Основной файл конфигурации Helm, содержащий метаданные о чартe, такие как версия и описание.
- **eugenetask-0.1.0.tgz**: Архивированный пакет Helm chart, готовый для развертывания.
- **values.yaml**: Файл со значениями по умолчанию для параметров чартa, который может быть изменен для настройки развертывания.

## Директория `docker_registry_Helm_Chart`

Эта директория содержит Helm chart для управления Docker Registry в Kubernetes. Основные файлы и шаблоны:

### Chart.yaml

- Основной файл конфигурации Helm, содержащий метаданные о чартe, такие как версия и описание.

### values.yaml

- Файл со значениями по умолчанию для параметров чартa, который может быть изменен для настройки развертывания.

### Шаблоны Helm в `docker_registry_Helm_Chart/templates`

- **ClusterIssuer.yaml**: Конфигурация для управления сертификатами с использованием Cert-Manager.
- **deployment.yaml**: Определяет развертывание Docker Registry, включая количество реплик и используемые образы.
- **dr-secret.yaml**: Управляет секретами для доступа к Docker Registry.
- **ingress.yaml**: Определяет правила входа для доступа к Docker Registry извне.
- **namespace.yaml**: Создает namespace для изоляции ресурсов Docker Registry.
- **pv-pvc.yaml**: Конфигурация для постоянных томов и заявок на хранение данных Docker Registry.
- **service.yaml**: Описывает, как Docker Registry будет доступен в сети, включая тип сервиса и порты.

## Рабочий процесс развертывания

### Репозиторий Docker и Helm Chart

При каждом коммите в этот репозиторий автоматически создаются Docker-образы, которые затем отправляются в Docker-реестр. Обновленные Helm charts также сохраняются и отправляются в Docker-реестр.

### Репозиторий конфигурации ArgoCD

Отслеживает изменения в версии Helm chart и запускает развертывания в ArgoCD. Это позволяет автоматизировать процесс развертывания и гарантирует, что приложение всегда будет развернуто с актуальной конфигурацией.

## P.S.
Секреты намеренно искажены